import{r as E,a as Be,R as _,c as Ce,g as qe,b as Le,d as Me}from"./vendor-C0IgI0Tm.js";(function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const h of document.querySelectorAll('link[rel="modulepreload"]'))s(h);new MutationObserver(h=>{for(const g of h)if(g.type==="childList")for(const p of g.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&s(p)}).observe(document,{childList:!0,subtree:!0});function c(h){const g={};return h.integrity&&(g.integrity=h.integrity),h.referrerPolicy&&(g.referrerPolicy=h.referrerPolicy),h.crossOrigin==="use-credentials"?g.credentials="include":h.crossOrigin==="anonymous"?g.credentials="omit":g.credentials="same-origin",g}function s(h){if(h.ep)return;h.ep=!0;const g=c(h);fetch(h.href,g)}})();var Pe={exports:{}},ne={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _e=E,ze=Symbol.for("react.element"),Re=Symbol.for("react.fragment"),Ze=Object.prototype.hasOwnProperty,$e=_e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Je={key:!0,ref:!0,__self:!0,__source:!0};function Ee(o,l,c){var s,h={},g=null,p=null;c!==void 0&&(g=""+c),l.key!==void 0&&(g=""+l.key),l.ref!==void 0&&(p=l.ref);for(s in l)Ze.call(l,s)&&!Je.hasOwnProperty(s)&&(h[s]=l[s]);if(o&&o.defaultProps)for(s in l=o.defaultProps,l)h[s]===void 0&&(h[s]=l[s]);return{$$typeof:ze,type:o,key:g,ref:p,props:h,_owner:$e.current}}ne.Fragment=Re;ne.jsx=Ee;ne.jsxs=Ee;Pe.exports=ne;var m=Pe.exports,Se,be=Be;Se=be.createRoot,be.hydrateRoot;/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Ge={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const We=o=>o.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),z=(o,l)=>{const c=E.forwardRef(({color:s="currentColor",size:h=24,strokeWidth:g=2,absoluteStrokeWidth:p,className:d="",children:u,...b},S)=>E.createElement("svg",{ref:S,...Ge,width:h,height:h,stroke:s,strokeWidth:p?Number(g)*24/Number(h):g,className:["lucide",`lucide-${We(o)}`,d].join(" "),...b},[...l.map(([N,I])=>E.createElement(N,I)),...Array.isArray(u)?u:[u]]));return c.displayName=`${o}`,c};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ve=z("Crop",[["path",{d:"M6 2v14a2 2 0 0 0 2 2h14",key:"ron5a4"}],["path",{d:"M18 22V8a2 2 0 0 0-2-2H2",key:"7s9ehn"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=z("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qe=z("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ke=z("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ye=z("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xe=z("ZoomOut",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);var Ae={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},ve=_.createContext&&_.createContext(Ae),et=["attr","size","title"];function tt(o,l){if(o==null)return{};var c=rt(o,l),s,h;if(Object.getOwnPropertySymbols){var g=Object.getOwnPropertySymbols(o);for(h=0;h<g.length;h++)s=g[h],!(l.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(o,s)&&(c[s]=o[s])}return c}function rt(o,l){if(o==null)return{};var c={};for(var s in o)if(Object.prototype.hasOwnProperty.call(o,s)){if(l.indexOf(s)>=0)continue;c[s]=o[s]}return c}function re(){return re=Object.assign?Object.assign.bind():function(o){for(var l=1;l<arguments.length;l++){var c=arguments[l];for(var s in c)Object.prototype.hasOwnProperty.call(c,s)&&(o[s]=c[s])}return o},re.apply(this,arguments)}function we(o,l){var c=Object.keys(o);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(o);l&&(s=s.filter(function(h){return Object.getOwnPropertyDescriptor(o,h).enumerable})),c.push.apply(c,s)}return c}function ae(o){for(var l=1;l<arguments.length;l++){var c=arguments[l]!=null?arguments[l]:{};l%2?we(Object(c),!0).forEach(function(s){at(o,s,c[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(c)):we(Object(c)).forEach(function(s){Object.defineProperty(o,s,Object.getOwnPropertyDescriptor(c,s))})}return o}function at(o,l,c){return l=nt(l),l in o?Object.defineProperty(o,l,{value:c,enumerable:!0,configurable:!0,writable:!0}):o[l]=c,o}function nt(o){var l=it(o,"string");return typeof l=="symbol"?l:l+""}function it(o,l){if(typeof o!="object"||!o)return o;var c=o[Symbol.toPrimitive];if(c!==void 0){var s=c.call(o,l||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(l==="string"?String:Number)(o)}function De(o){return o&&o.map((l,c)=>_.createElement(l.tag,ae({key:c},l.attr),De(l.child)))}function ot(o){return l=>_.createElement(st,re({attr:ae({},o.attr)},l),De(o.child))}function st(o){var l=c=>{var{attr:s,size:h,title:g}=o,p=tt(o,et),d=h||c.size||"1em",u;return c.className&&(u=c.className),o.className&&(u=(u?u+" ":"")+o.className),_.createElement("svg",re({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},c.attr,s,p,{className:u,style:ae(ae({color:o.color||c.color},c.style),o.style),height:d,width:d,xmlns:"http://www.w3.org/2000/svg"}),g&&_.createElement("title",null,g),o.children)};return ve!==void 0?_.createElement(ve.Consumer,null,c=>l(c)):l(Ae)}function lt(o){return ot({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M48 87.2c0 5.8 2 11.4 5.6 15.7l152.2 179.8c3.6 4.3 5.6 9.9 5.6 15.7v107c0 10 5.9 18.8 14.6 22l55 19.8c9.6 3.5 19.6-4.3 19.6-15.3V298.3c0-5.8 2-11.4 5.6-15.7l152.2-179.8c3.6-4.3 5.6-9.9 5.6-15.7 0-12.8-9.6-23.2-21.4-23.2H69.4C57.6 64 48 74.4 48 87.2z"},child:[]}]})(o)}const Oe=({toggleDarkMode:o,zoomIn:l,zoomOut:c,pan:s,crop:h,adjustBrightness:g,adjustContrast:p,draw:d,addText:u})=>{function b(S){console.log("Window slider button clicked")}return m.jsxs("div",{className:"fixed right-0 top-0 p-4 flex flex-col gap-2",children:[m.jsx("button",{onClick:o,className:"bg-primary text-black p-2 rounded-lg shadow-lg transition-colors",children:m.jsx(Qe,{size:20})}),m.jsx("button",{onClick:l,className:"bg-primary text-black p-2 rounded-lg shadow-lg transition-colors",children:m.jsx(Ye,{size:20})}),m.jsx("button",{onClick:c,className:"bg-primary text-black p-2 rounded-lg shadow-lg transition-colors",children:m.jsx(Xe,{size:20})}),m.jsx("button",{onClick:d,className:"bg-primary text-black p-2 rounded-lg shadow-lg transition-colors hover:bg-opacity-80",children:m.jsx(He,{size:20})}),m.jsxs("button",{onClick:b,className:"bg-primary text-black p-2 rounded-lg shadow-lg transition-colors",children:[m.jsx(lt,{className:"w-6 h-6"})," "]}),m.jsx("button",{onClick:h,className:"bg-primary text-black p-2 rounded-lg shadow-lg transition-colors hover:bg-opacity-80",children:m.jsx(Ve,{size:20})})]})},ue=Ce(o=>({isDarkMode:!1,zoom:1,setZoom:l=>o({zoom:l}),toggleDarkMode:()=>o(l=>({isDarkMode:!l.isDarkMode}))})),dt=()=>{const{zoom:o,setZoom:l,toggleDarkMode:c,isDarkMode:s}=ue(),h=()=>{l(Math.min(o+.1,3))},g=()=>{l(Math.max(o-.1,1))};return m.jsx("div",{className:s?"dark":"",children:m.jsx(Oe,{toggleDarkMode:c,zoomIn:h,zoomOut:g,pan:()=>{},crop:()=>{},adjustBrightness:()=>{},adjustContrast:()=>{},draw:()=>{},addText:()=>{}})})};var ke={exports:{}};const ct={},ft=Object.freeze(Object.defineProperty({__proto__:null,default:ct},Symbol.toStringTag,{value:"Module"})),ut=qe(ft);/*! dicom-parser - 1.8.12 - 2023-02-20 | (c) 2017 Chris Hafey | https://github.com/cornerstonejs/dicomParser */(function(o,l){(function(c,s){o.exports=s(ut)})(Le,function(c){return h=[function(p,d){p.exports=c},function(p,d,u){u.r(d),u.d(d,"isStringVr",function(){return S}),u.d(d,"isPrivateTag",function(){return N}),u.d(d,"parsePN",function(){return I}),u.d(d,"parseTM",function(){return R}),u.d(d,"parseDA",function(){return D}),u.d(d,"explicitElementToString",function(){return F}),u.d(d,"explicitDataSetToJS",function(){return Z}),u.d(d,"createJPEGBasicOffsetTable",function(){return Q}),u.d(d,"parseDicomDataSetExplicit",function(){return X}),u.d(d,"parseDicomDataSetImplicit",function(){return ee}),u.d(d,"readFixedString",function(){return U}),u.d(d,"alloc",function(){return W}),u.d(d,"version",function(){return he}),u.d(d,"bigEndianByteArrayParser",function(){return le}),u.d(d,"ByteStream",function(){return B}),u.d(d,"sharedCopy",function(){return V}),u.d(d,"DataSet",function(){return v}),u.d(d,"findAndSetUNElementLength",function(){return K}),u.d(d,"findEndOfEncapsulatedElement",function(){return $}),u.d(d,"findItemDelimitationItemAndSetElementLength",function(){return A}),u.d(d,"littleEndianByteArrayParser",function(){return C}),u.d(d,"parseDicom",function(){return ge}),u.d(d,"readDicomElementExplicit",function(){return G}),u.d(d,"readDicomElementImplicit",function(){return M}),u.d(d,"readEncapsulatedImageFrame",function(){return ce}),u.d(d,"readEncapsulatedPixelData",function(){return xe}),u.d(d,"readEncapsulatedPixelDataFromFragments",function(){return te}),u.d(d,"readPart10Header",function(){return de}),u.d(d,"readSequenceItemsExplicit",function(){return se}),u.d(d,"readSequenceItemsImplicit",function(){return Y}),u.d(d,"readSequenceItem",function(){return T}),u.d(d,"readTag",function(){return O});var b={AE:!0,AS:!0,AT:!1,CS:!0,DA:!0,DS:!0,DT:!0,FL:!1,FD:!1,IS:!0,LO:!0,LT:!0,OB:!1,OD:!1,OF:!1,OW:!1,PN:!0,SH:!0,SL:!1,SQ:!1,SS:!1,ST:!0,TM:!0,UI:!0,UL:!1,UN:void 0,UR:!0,US:!1,UT:!0},S=function(e){return b[e]},N=function(e){if(e=parseInt(e[4],16),isNaN(e))throw"dicomParser.isPrivateTag: cannot parse last character of group";return e%2==1},I=function(e){if(e!==void 0)return e=e.split("^"),{familyName:e[0],givenName:e[1],middleName:e[2],prefix:e[3],suffix:e[4]}};function R(e,r){if(2<=e.length){var a=parseInt(e.substring(0,2),10),t=4<=e.length?parseInt(e.substring(2,4),10):void 0,n=6<=e.length?parseInt(e.substring(4,6),10):void 0,i=8<=e.length?e.substring(7,13):void 0,i=i?parseInt(i,10)*Math.pow(10,6-i.length):void 0;if(r&&(isNaN(a)||t!==void 0&&isNaN(t)||n!==void 0&&isNaN(n)||i!==void 0&&isNaN(i)||a<0||23<a||t&&(t<0||59<t)||n&&(n<0||59<n)||i&&(i<0||999999<i)))throw"invalid TM '".concat(e,"'");return{hours:a,minutes:t,seconds:n,fractionalSeconds:i}}if(r)throw"invalid TM '".concat(e,"'")}function L(e,r,a){return!isNaN(a)&&0<r&&r<=12&&0<e&&e<=function(t,n){switch(t){case 2:return n%4==0&&n%100||n%400==0?29:28;case 9:case 4:case 6:case 11:return 30;default:return 31}}(r,a)}function D(e,r){if(e&&e.length===8){var a=parseInt(e.substring(0,4),10),t=parseInt(e.substring(4,6),10),n=parseInt(e.substring(6,8),10);if(r&&L(n,t,a)!==!0)throw"invalid DA '".concat(e,"'");return{year:a,month:t,day:n}}if(r)throw"invalid DA '".concat(e,"'")}function F(e,r){if(e===void 0||r===void 0)throw"dicomParser.explicitElementToString: missing required parameters";if(r.vr===void 0)throw"dicomParser.explicitElementToString: cannot convert implicit element to string";var a,t=r.vr,n=r.tag;function i(x,w){for(var k="",P=0;P<x;P++)P!==0&&(k+="/"),k+=w.call(e,n,P).toString();return k}if(S(t)===!0)a=e.string(n);else{if(t==="AT"){var f=e.uint32(n);return f===void 0?void 0:"x".concat((f=f<0?4294967295+f+1:f).toString(16).toUpperCase())}t==="US"?a=i(r.length/2,e.uint16):t==="SS"?a=i(r.length/2,e.int16):t==="UL"?a=i(r.length/4,e.uint32):t==="SL"?a=i(r.length/4,e.int32):t==="FD"?a=i(r.length/8,e.double):t==="FL"&&(a=i(r.length/4,e.float))}return a}function Z(e,r){if(e===void 0)throw"dicomParser.explicitDataSetToJS: missing required parameter dataSet";r=r||{omitPrivateAttibutes:!0,maxElementLength:128};var a,t={};for(a in e.elements){var n=e.elements[a];if(r.omitPrivateAttibutes!==!0||!N(a))if(n.items){for(var i=[],f=0;f<n.items.length;f++)i.push(Z(n.items[f].dataSet,r));t[a]=i}else{var x=void 0;n.length<r.maxElementLength&&(x=F(e,n)),t[a]=x!==void 0?x:{dataOffset:n.dataOffset,length:n.length}}}return t}function H(e,r){return e.byteArray[r]===255&&e.byteArray[r+1]===217}function ie(e,r,a){for(var t,n,i=a;i<r.fragments.length;i++)if(t=e,n=i,n=r.fragments[n],!(!H(t,n.position+n.length-2)&&!H(t,n.position+n.length-3)))return i}function Q(e,r,a){if(e===void 0)throw"dicomParser.createJPEGBasicOffsetTable: missing required parameter dataSet";if(r===void 0)throw"dicomParser.createJPEGBasicOffsetTable: missing required parameter pixelDataElement";if(r.tag!=="x7fe00010")throw"dicomParser.createJPEGBasicOffsetTable: parameter 'pixelDataElement' refers to non pixel data tag (expected tag = x7fe00010'";if(r.encapsulatedPixelData!==!0||r.hadUndefinedLength!==!0||r.basicOffsetTable===void 0||r.fragments===void 0||r.fragments.length<=0)throw"dicomParser.createJPEGBasicOffsetTable: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(a&&a.length<=0)throw"dicomParser.createJPEGBasicOffsetTable: parameter 'fragments' must not be zero length";a=a||r.fragments;for(var t=[],n=0;;){t.push(r.fragments[n].offset);var i=ie(e,r,n);if(i===void 0||i===r.fragments.length-1)return t;n=i+1}}function O(a){if(a===void 0)throw"dicomParser.readTag: missing required parameter 'byteStream'";var r=256*a.readUint16()*256,a=a.readUint16();return"x".concat("00000000".concat((r+a).toString(16)).substr(-8))}function $(e,r,a){if(e===void 0)throw"dicomParser.findEndOfEncapsulatedElement: missing required parameter 'byteStream'";if(r===void 0)throw"dicomParser.findEndOfEncapsulatedElement: missing required parameter 'element'";if(r.encapsulatedPixelData=!0,r.basicOffsetTable=[],r.fragments=[],O(e)!=="xfffee000")throw"dicomParser.findEndOfEncapsulatedElement: basic offset table not found";for(var t=e.readUint32()/4,n=0;n<t;n++){var i=e.readUint32();r.basicOffsetTable.push(i)}for(var f=e.position;e.position<e.byteArray.length;){var x=O(e),w=e.readUint32();if(x==="xfffee0dd")return e.seek(w),void(r.length=e.position-r.dataOffset);if(x!=="xfffee000")return a&&a.push("unexpected tag ".concat(x," while searching for end of pixel data element with undefined length")),w>e.byteArray.length-e.position&&(w=e.byteArray.length-e.position),r.fragments.push({offset:e.position-f-8,position:e.position,length:w}),e.seek(w),void(r.length=e.position-r.dataOffset);r.fragments.push({offset:e.position-f-8,position:e.position,length:w}),e.seek(w)}a&&a.push("pixel data element ".concat(r.tag," missing sequence delimiter tag xfffee0dd"))}function K(e,r){if(e===void 0)throw"dicomParser.findAndSetUNElementLength: missing required parameter 'byteStream'";for(var a=e.byteArray.length-8;e.position<=a;)if(e.readUint16()===65534){var t=e.readUint16();if(t===57565)return e.readUint32()!==0&&e.warnings("encountered non zero length following item delimiter at position ".concat(e.position-4," while reading element of undefined length with tag ").concat(r.tag)),void(r.length=e.position-r.dataOffset)}r.length=e.byteArray.length-r.dataOffset,e.seek(e.byteArray.length-e.position)}function U(e,r,a){if(a<0)throw"dicomParser.readFixedString - length cannot be less than 0";if(r+a>e.length)throw"dicomParser.readFixedString: attempt to read past end of buffer";for(var t,n="",i=0;i<a;i++){if((t=e[r+i])===0)return r+=a,n;n+=String.fromCharCode(t)}return n}function oe(e,r){for(var a=0;a<r.length;a++){var t=r[a];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}function y(e,r){return e.parser!==void 0?e.parser:r}var v=function(){function e(t,n,i){(function(f,x){if(!(f instanceof x))throw new TypeError("Cannot call a class as a function")})(this,e),this.byteArrayParser=t,this.byteArray=n,this.elements=i}var r,a;return r=e,(a=[{key:"uint16",value:function(t,n){if(t=this.elements[t],n=n!==void 0?n:0,t&&t.length!==0)return y(t,this.byteArrayParser).readUint16(this.byteArray,t.dataOffset+2*n)}},{key:"int16",value:function(t,n){if(t=this.elements[t],n=n!==void 0?n:0,t&&t.length!==0)return y(t,this.byteArrayParser).readInt16(this.byteArray,t.dataOffset+2*n)}},{key:"uint32",value:function(t,n){if(t=this.elements[t],n=n!==void 0?n:0,t&&t.length!==0)return y(t,this.byteArrayParser).readUint32(this.byteArray,t.dataOffset+4*n)}},{key:"int32",value:function(t,n){if(t=this.elements[t],n=n!==void 0?n:0,t&&t.length!==0)return y(t,this.byteArrayParser).readInt32(this.byteArray,t.dataOffset+4*n)}},{key:"float",value:function(t,n){if(t=this.elements[t],n=n!==void 0?n:0,t&&t.length!==0)return y(t,this.byteArrayParser).readFloat(this.byteArray,t.dataOffset+4*n)}},{key:"double",value:function(t,n){if(t=this.elements[t],n=n!==void 0?n:0,t&&t.length!==0)return y(t,this.byteArrayParser).readDouble(this.byteArray,t.dataOffset+8*n)}},{key:"numStringValues",value:function(t){if(t=this.elements[t],t&&0<t.length)return t=U(this.byteArray,t.dataOffset,t.length).match(/\\/g),t===null?1:t.length+1}},{key:"string",value:function(t,n){if(t=this.elements[t],t&&t.Value)return t.Value;if(t&&0<t.length)return t=U(this.byteArray,t.dataOffset,t.length),0<=n?t.split("\\")[n].trim():t.trim()}},{key:"text",value:function(t,n){if(t=this.elements[t],t&&0<t.length)return t=U(this.byteArray,t.dataOffset,t.length),0<=n?t.split("\\")[n].replace(/ +$/,""):t.replace(/ +$/,"")}},{key:"floatString",value:function(t,n){var i=this.elements[t];if(i&&0<i.length&&(n=this.string(t,n=n!==void 0?n:0),n!==void 0))return parseFloat(n)}},{key:"intString",value:function(t,n){var i=this.elements[t];if(i&&0<i.length&&(n=this.string(t,n=n!==void 0?n:0),n!==void 0))return parseInt(n)}},{key:"attributeTag",value:function(t){var n=this.elements[t];if(n&&n.length===4){var i=y(n,this.byteArrayParser).readUint16,t=this.byteArray,n=n.dataOffset;return"x".concat("00000000".concat((256*i(t,n)*256+i(t,n+2)).toString(16)).substr(-8))}}}])&&oe(r.prototype,a),Object.defineProperty(r,"prototype",{writable:!1}),e}();function A(e,r){if(e===void 0)throw"dicomParser.readDicomElementImplicit: missing required parameter 'byteStream'";for(var a=e.byteArray.length-8;e.position<=a;)if(e.readUint16()===65534){var t=e.readUint16();if(t===57357)return e.readUint32()!==0&&e.warnings("encountered non zero length following item delimiter at position ".concat(e.position-4," while reading element of undefined length with tag ").concat(r.tag)),void(r.length=e.position-r.dataOffset)}r.length=e.byteArray.length-r.dataOffset,e.seek(e.byteArray.length-e.position)}var J=function(e,r){return e.vr!==void 0?e.vr==="SQ":r.position+4<=r.byteArray.length?(e=O(r),r.seek(-4),e==="xfffee000"||e==="xfffee0dd"):(r.warnings.push("eof encountered before finding sequence item tag or sequence delimiter tag in peeking to determine VR"),!1)};function M(e,r,a){if(e===void 0)throw"dicomParser.readDicomElementImplicit: missing required parameter 'byteStream'";var t=O(e),t={tag:t,vr:a!==void 0?a(t):void 0,length:e.readUint32(),dataOffset:e.position};return t.length===4294967295&&(t.hadUndefinedLength=!0),t.tag===r||(!J(t,e)||N(t.tag)&&!t.hadUndefinedLength?t.hadUndefinedLength?A(e,t):e.seek(t.length):(Y(e,t,a),N(t.tag)&&(t.items=void 0))),t}function T(e){if(e===void 0)throw"dicomParser.readSequenceItem: missing required parameter 'byteStream'";var r={tag:O(e),length:e.readUint32(),dataOffset:e.position};if(r.tag!=="xfffee000")throw"dicomParser.readSequenceItem: item tag (FFFE,E000) not found at offset ".concat(e.position);return r}function me(e,r){var a=T(e);return a.length===4294967295?(a.hadUndefinedLength=!0,a.dataSet=function(t,n){for(var i={};t.position<t.byteArray.length;){var f=M(t,void 0,n);if((i[f.tag]=f).tag==="xfffee00d")return new v(t.byteArrayParser,t.byteArray,i)}return t.warnings.push("eof encountered before finding sequence item delimiter in sequence item of undefined length"),new v(t.byteArrayParser,t.byteArray,i)}(e,r),a.length=e.position-a.dataOffset):(a.dataSet=new v(e.byteArrayParser,e.byteArray,{}),ee(a.dataSet,e,e.position+a.length,{vrCallback:r})),a}function Y(e,r,a){if(e===void 0)throw"dicomParser.readSequenceItemsImplicit: missing required parameter 'byteStream'";if(r===void 0)throw"dicomParser.readSequenceItemsImplicit: missing required parameter 'element'";r.items=[],(r.length===4294967295?function(t,n,i){for(;t.position+4<=t.byteArray.length;){var f=O(t);if(t.seek(-4),f==="xfffee0dd")return n.length=t.position-n.dataOffset,t.seek(8);f=me(t,i),n.items.push(f)}t.warnings.push("eof encountered before finding sequence delimiter in sequence of undefined length"),n.length=t.byteArray.length-n.dataOffset}:function(t,n,i){for(var f=n.dataOffset+n.length;t.position<f;){var x=me(t,i);n.items.push(x)}})(e,r,a)}function pe(e,r){var a=T(e);return a.length===4294967295?(a.hadUndefinedLength=!0,a.dataSet=function(t,n){for(var i={};t.position<t.byteArray.length;){var f=G(t,n);if((i[f.tag]=f).tag==="xfffee00d")return new v(t.byteArrayParser,t.byteArray,i)}return n.push("eof encountered before finding item delimiter tag while reading sequence item of undefined length"),new v(t.byteArrayParser,t.byteArray,i)}(e,r),a.length=e.position-a.dataOffset):(a.dataSet=new v(e.byteArrayParser,e.byteArray,{}),X(a.dataSet,e,e.position+a.length)),a}function se(e,r,a){if(e===void 0)throw"dicomParser.readSequenceItemsExplicit: missing required parameter 'byteStream'";if(r===void 0)throw"dicomParser.readSequenceItemsExplicit: missing required parameter 'element'";r.items=[],(r.length===4294967295?function(t,n,i){for(;t.position+4<=t.byteArray.length;){var f=O(t);if(t.seek(-4),f==="xfffee0dd")return n.length=t.position-n.dataOffset,t.seek(8);f=pe(t,i),n.items.push(f)}i.push("eof encountered before finding sequence delimitation tag while reading sequence of undefined length"),n.length=t.position-n.dataOffset}:function(t,n,i){for(var f=n.dataOffset+n.length;t.position<f;){var x=pe(t,i);n.items.push(x)}})(e,r,a)}var je=function(e){return e==="OB"||e==="OD"||e==="OL"||e==="OW"||e==="SQ"||e==="OF"||e==="UC"||e==="UR"||e==="UT"||e==="UN"?4:2};function G(e,r,a){if(e===void 0)throw"dicomParser.readDicomElementExplicit: missing required parameter 'byteStream'";var t={tag:O(e),vr:e.readFixedString(2)};return je(t.vr)===2?t.length=e.readUint16():(e.seek(2),t.length=e.readUint32()),t.dataOffset=e.position,t.length===4294967295&&(t.hadUndefinedLength=!0),t.tag===a||(t.vr==="SQ"?se(e,t,r):t.length===4294967295?t.tag==="x7fe00010"?$(e,t,r):(t.vr==="UN"?Y:A)(e,t):e.seek(t.length)),t}function X(e,r,a){var t=3<arguments.length&&arguments[3]!==void 0?arguments[3]:{};if(a=a===void 0?r.byteArray.length:a,r===void 0)throw"dicomParser.parseDicomDataSetExplicit: missing required parameter 'byteStream'";if(a<r.position||a>r.byteArray.length)throw"dicomParser.parseDicomDataSetExplicit: invalid value for parameter 'maxP osition'";for(var n=e.elements;r.position<a;){var i=G(r,e.warnings,t.untilTag);if((n[i.tag]=i).tag===t.untilTag)return}if(r.position>a)throw"dicomParser:parseDicomDataSetExplicit: buffer overrun"}function ee(e,r,a){var t=3<arguments.length&&arguments[3]!==void 0?arguments[3]:{};if(a=a===void 0?e.byteArray.length:a,r===void 0)throw"dicomParser.parseDicomDataSetImplicit: missing required parameter 'byteStream'";if(a<r.position||a>r.byteArray.length)throw"dicomParser.parseDicomDataSetImplicit: invalid value for parameter 'maxPosition'";for(var n=e.elements;r.position<a;){var i=M(r,t.untilTag,t.vrCallback);if((n[i.tag]=i).tag===t.untilTag)return}}function W(e,r){if(typeof Buffer<"u"&&e instanceof Buffer)return Buffer.alloc(r);if(e instanceof Uint8Array)return new Uint8Array(r);throw"dicomParser.alloc: unknown type for byteArray"}var he="1.8.12",le={readUint16:function(e,r){if(r<0)throw"bigEndianByteArrayParser.readUint16: position cannot be less than 0";if(r+2>e.length)throw"bigEndianByteArrayParser.readUint16: attempt to read past end of buffer";return(e[r]<<8)+e[r+1]},readInt16:function(e,r){if(r<0)throw"bigEndianByteArrayParser.readInt16: position cannot be less than 0";if(r+2>e.length)throw"bigEndianByteArrayParser.readInt16: attempt to read past end of buffer";return r=(e[r]<<8)+e[r+1],r=32768&r?r-65535-1:r},readUint32:function(e,r){if(r<0)throw"bigEndianByteArrayParser.readUint32: position cannot be less than 0";if(r+4>e.length)throw"bigEndianByteArrayParser.readUint32: attempt to read past end of buffer";return 256*(256*(256*e[r]+e[r+1])+e[r+2])+e[r+3]},readInt32:function(e,r){if(r<0)throw"bigEndianByteArrayParser.readInt32: position cannot be less than 0";if(r+4>e.length)throw"bigEndianByteArrayParser.readInt32: attempt to read past end of buffer";return(e[r]<<24)+(e[r+1]<<16)+(e[r+2]<<8)+e[r+3]},readFloat:function(e,r){if(r<0)throw"bigEndianByteArrayParser.readFloat: position cannot be less than 0";if(r+4>e.length)throw"bigEndianByteArrayParser.readFloat: attempt to read past end of buffer";var a=new Uint8Array(4);return a[3]=e[r],a[2]=e[r+1],a[1]=e[r+2],a[0]=e[r+3],new Float32Array(a.buffer)[0]},readDouble:function(e,r){if(r<0)throw"bigEndianByteArrayParser.readDouble: position cannot be less than 0";if(r+8>e.length)throw"bigEndianByteArrayParser.readDouble: attempt to read past end of buffer";var a=new Uint8Array(8);return a[7]=e[r],a[6]=e[r+1],a[5]=e[r+2],a[4]=e[r+3],a[3]=e[r+4],a[2]=e[r+5],a[1]=e[r+6],a[0]=e[r+7],new Float64Array(a.buffer)[0]}};function V(e,r,a){if(typeof Buffer<"u"&&e instanceof Buffer)return e.slice(r,r+a);if(e instanceof Uint8Array)return new Uint8Array(e.buffer,e.byteOffset+r,a);throw"dicomParser.from: unknown type for byteArray"}function Ie(e,r){for(var a=0;a<r.length;a++){var t=r[a];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}var B=function(){function e(t,n,i){if(function(f,x){if(!(f instanceof x))throw new TypeError("Cannot call a class as a function")}(this,e),t===void 0)throw"dicomParser.ByteStream: missing required parameter 'byteArrayParser'";if(n===void 0)throw"dicomParser.ByteStream: missing required parameter 'byteArray'";if(!(n instanceof Uint8Array)&&(typeof Buffer>"u"||!(n instanceof Buffer)))throw"dicomParser.ByteStream: parameter byteArray is not of type Uint8Array or Buffer";if(i<0)throw"dicomParser.ByteStream: parameter 'position' cannot be less than 0";if(i>=n.length)throw"dicomParser.ByteStream: parameter 'position' cannot be greater than or equal to 'byteArray' length";this.byteArrayParser=t,this.byteArray=n,this.position=i||0,this.warnings=[]}var r,a;return r=e,(a=[{key:"seek",value:function(t){if(this.position+t<0)throw"dicomParser.ByteStream.prototype.seek: cannot seek to position < 0";this.position+=t}},{key:"readByteStream",value:function(t){if(this.position+t>this.byteArray.length)throw"dicomParser.ByteStream.prototype.readByteStream: readByteStream - buffer overread";var n=V(this.byteArray,this.position,t);return this.position+=t,new e(this.byteArrayParser,n)}},{key:"getSize",value:function(){return this.byteArray.length}},{key:"readUint16",value:function(){var t=this.byteArrayParser.readUint16(this.byteArray,this.position);return this.position+=2,t}},{key:"readUint32",value:function(){var t=this.byteArrayParser.readUint32(this.byteArray,this.position);return this.position+=4,t}},{key:"readFixedString",value:function(t){var n=U(this.byteArray,this.position,t);return this.position+=t,n}}])&&Ie(r.prototype,a),Object.defineProperty(r,"prototype",{writable:!1}),e}(),C={readUint16:function(e,r){if(r<0)throw"littleEndianByteArrayParser.readUint16: position cannot be less than 0";if(r+2>e.length)throw"littleEndianByteArrayParser.readUint16: attempt to read past end of buffer";return e[r]+256*e[r+1]},readInt16:function(e,r){if(r<0)throw"littleEndianByteArrayParser.readInt16: position cannot be less than 0";if(r+2>e.length)throw"littleEndianByteArrayParser.readInt16: attempt to read past end of buffer";return r=e[r]+(e[r+1]<<8),r=32768&r?r-65535-1:r},readUint32:function(e,r){if(r<0)throw"littleEndianByteArrayParser.readUint32: position cannot be less than 0";if(r+4>e.length)throw"littleEndianByteArrayParser.readUint32: attempt to read past end of buffer";return e[r]+256*e[r+1]+256*e[r+2]*256+256*e[r+3]*256*256},readInt32:function(e,r){if(r<0)throw"littleEndianByteArrayParser.readInt32: position cannot be less than 0";if(r+4>e.length)throw"littleEndianByteArrayParser.readInt32: attempt to read past end of buffer";return e[r]+(e[r+1]<<8)+(e[r+2]<<16)+(e[r+3]<<24)},readFloat:function(e,r){if(r<0)throw"littleEndianByteArrayParser.readFloat: position cannot be less than 0";if(r+4>e.length)throw"littleEndianByteArrayParser.readFloat: attempt to read past end of buffer";var a=new Uint8Array(4);return a[0]=e[r],a[1]=e[r+1],a[2]=e[r+2],a[3]=e[r+3],new Float32Array(a.buffer)[0]},readDouble:function(e,r){if(r<0)throw"littleEndianByteArrayParser.readDouble: position cannot be less than 0";if(r+8>e.length)throw"littleEndianByteArrayParser.readDouble: attempt to read past end of buffer";var a=new Uint8Array(8);return a[0]=e[r],a[1]=e[r+1],a[2]=e[r+2],a[3]=e[r+3],a[4]=e[r+4],a[5]=e[r+5],a[6]=e[r+6],a[7]=e[r+7],new Float64Array(a.buffer)[0]}};function de(e){var r=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};if(e===void 0)throw"dicomParser.readPart10Header: missing required parameter 'byteArray'";var a=r.TransferSyntaxUID,t=new B(C,e);return function(){var n=function(){if(t.getSize()<=132&&a)return!1;if(t.seek(128),t.readFixedString(4)==="DICM")return!0;if(!(r||{}).TransferSyntaxUID)throw"dicomParser.readPart10Header: DICM prefix not found at location 132 - this is not a valid DICOM P10 file.";return t.seek(0),!1}(),i=[],f={};if(!n)return t.position=0,{elements:{x00020010:{tag:"x00020010",vr:"UI",Value:a}},warnings:i};for(;t.position<t.byteArray.length;){var x=t.position,w=G(t,i);if("x0002ffff"<w.tag){t.position=x;break}w.parser=C,f[w.tag]=w}return(n=new v(t.byteArrayParser,t.byteArray,f)).warnings=t.warnings,n.position=t.position,n}()}var Fe="1.2.840.10008.1.2.2";function ge(e){var r=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};if(e===void 0)throw new Error("dicomParser.parseDicom: missing required parameter 'byteArray'");var a,t=function(i){if(i.elements.x00020010===void 0)throw new Error("dicomParser.parseDicom: missing required meta header attribute 0002,0010");return i=i.elements.x00020010,i&&i.Value||U(e,i.dataOffset,i.length)};function n(w){var x=t(w),f=x!=="1.2.840.10008.1.2",x=function(k,P){var fe=Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]";if(k!=="1.2.840.10008.1.2.1.99")return new B(k===Fe?le:C,e,P);if(r&&r.inflater)return k=r.inflater(e,P),new B(C,k,0);if(fe==!0){var j=u(0),q=V(e,P,e.length-P),j=j.inflateRawSync(q),q=W(e,j.length+P);return e.copy(q,0,0,P),j.copy(q,P),new B(C,q,0)}if(typeof pako>"u")throw"dicomParser.parseDicom: no inflater available to handle deflate transfer syntax";return j=e.slice(P),q=pako.inflateRaw(j),(j=W(e,q.length+P)).set(e.slice(0,P),0),j.set(q,P),new B(C,j,0)}(x,w.position),w=new v(x.byteArrayParser,x.byteArray,{});w.warnings=x.warnings;try{(f?X:ee)(w,x,x.byteArray.length,r)}catch(k){throw{exception:k,dataSet:w}}return w}return function(i,f){for(var x in i.elements)i.elements.hasOwnProperty(x)&&(f.elements[x]=i.elements[x]);return i.warnings!==void 0&&(f.warnings=i.warnings.concat(f.warnings)),f}(a=de(e,r),n(a))}var Ne=function(e,r,a){for(var t=0,n=r;n<r+a;n++)t+=e[n].length;return t};function te(e,f,a,t,n){if(n=n||f.fragments,e===void 0)throw"dicomParser.readEncapsulatedPixelDataFromFragments: missing required parameter 'dataSet'";if(f===void 0)throw"dicomParser.readEncapsulatedPixelDataFromFragments: missing required parameter 'pixelDataElement'";if(a===void 0)throw"dicomParser.readEncapsulatedPixelDataFromFragments: missing required parameter 'startFragmentIndex'";if((t=t||1)===void 0)throw"dicomParser.readEncapsulatedPixelDataFromFragments: missing required parameter 'numFragments'";if(f.tag!=="x7fe00010")throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'pixelDataElement' refers to non pixel data tag (expected tag = x7fe00010";if(f.encapsulatedPixelData!==!0||f.hadUndefinedLength!==!0||f.basicOffsetTable===void 0||f.fragments===void 0||f.fragments.length<=0)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(a<0)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'startFragmentIndex' must be >= 0";if(a>=f.fragments.length)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'startFragmentIndex' must be < number of fragments";if(t<1)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'numFragments' must be > 0";if(a+t>f.fragments.length)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'startFragment' + 'numFragments' < number of fragments";var i=new B(e.byteArrayParser,e.byteArray,f.dataOffset),f=T(i);if(f.tag!=="xfffee000")throw"dicomParser.readEncapsulatedPixelData: missing basic offset table xfffee000";i.seek(f.length);var x=i.position;if(t===1)return V(i.byteArray,x+n[a].offset+8,n[a].length);for(var f=Ne(n,a,t),w=W(i.byteArray,f),k=0,P=a;P<a+t;P++)for(var fe=x+n[P].offset+8,j=0;j<n[P].length;j++)w[k++]=i.byteArray[fe++];return w}var Ue=function(e,r){for(var a=0;a<e.length;a++)if(e[a].offset===r)return a},Te=function(e,r,a,t){if(e===r.length-1)return a.length-t;for(var n=r[e+1],i=t+1;i<a.length;i++)if(a[i].offset===n)return i-t;throw"dicomParser.calculateNumberOfFragmentsForFrame: could not find fragment with offset matching basic offset table"};function ce(e,r,a,t,n){if(t=t||r.basicOffsetTable,n=n||r.fragments,e===void 0)throw"dicomParser.readEncapsulatedImageFrame: missing required parameter 'dataSet'";if(r===void 0)throw"dicomParser.readEncapsulatedImageFrame: missing required parameter 'pixelDataElement'";if(a===void 0)throw"dicomParser.readEncapsulatedImageFrame: missing required parameter 'frameIndex'";if(t===void 0)throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' does not have basicOffsetTable";if(r.tag!=="x7fe00010")throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' refers to non pixel data tag (expected tag = x7fe00010)";if(r.encapsulatedPixelData!==!0)throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(r.hadUndefinedLength!==!0)throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' refers to pixel data element that does not have undefined length";if(r.fragments===void 0)throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' refers to pixel data element that does not have fragments";if(t.length===0)throw"dicomParser.readEncapsulatedImageFrame: basicOffsetTable has zero entries";if(a<0)throw"dicomParser.readEncapsulatedImageFrame: parameter 'frameIndex' must be >= 0";if(a>=t.length)throw"dicomParser.readEncapsulatedImageFrame: parameter 'frameIndex' must be < basicOffsetTable.length";var i=t[a],i=Ue(n,i);if(i===void 0)throw"dicomParser.readEncapsulatedImageFrame: unable to find fragment that matches basic offset table entry";return te(e,r,i,Te(a,t,n,i),n)}var ye=!1;function xe(e,r,a){if(ye||(ye=!0,console&&console.log&&console.log("WARNING: dicomParser.readEncapsulatedPixelData() has been deprecated")),e===void 0)throw"dicomParser.readEncapsulatedPixelData: missing required parameter 'dataSet'";if(r===void 0)throw"dicomParser.readEncapsulatedPixelData: missing required parameter 'element'";if(a===void 0)throw"dicomParser.readEncapsulatedPixelData: missing required parameter 'frame'";if(r.tag!=="x7fe00010")throw"dicomParser.readEncapsulatedPixelData: parameter 'element' refers to non pixel data tag (expected tag = x7fe00010)";if(r.encapsulatedPixelData!==!0||r.hadUndefinedLength!==!0||r.basicOffsetTable===void 0||r.fragments===void 0)throw"dicomParser.readEncapsulatedPixelData: parameter 'element' refers to pixel data element that does not have encapsulated pixel data";if(a<0)throw"dicomParser.readEncapsulatedPixelData: parameter 'frame' must be >= 0";return r.basicOffsetTable.length!==0?ce(e,r,a):te(e,r,0,r.fragments.length)}d.default={isStringVr:S,isPrivateTag:N,parsePN:I,parseTM:R,parseDA:D,explicitElementToString:F,explicitDataSetToJS:Z,createJPEGBasicOffsetTable:Q,parseDicomDataSetExplicit:X,parseDicomDataSetImplicit:ee,readFixedString:U,alloc:W,version:he,bigEndianByteArrayParser:le,ByteStream:B,sharedCopy:V,DataSet:v,findAndSetUNElementLength:K,findEndOfEncapsulatedElement:$,findItemDelimitationItemAndSetElementLength:A,littleEndianByteArrayParser:C,parseDicom:ge,readDicomElementExplicit:G,readDicomElementImplicit:M,readEncapsulatedImageFrame:ce,readEncapsulatedPixelData:xe,readEncapsulatedPixelDataFromFragments:te,readPart10Header:de,readSequenceItemsExplicit:se,readSequenceItemsImplicit:Y,readSequenceItem:T,readTag:O,LEI:"1.2.840.10008.1.2",LEE:"1.2.840.10008.1.2.1"}}],g={},s.m=h,s.c=g,s.d=function(p,d,u){s.o(p,d)||Object.defineProperty(p,d,{enumerable:!0,get:u})},s.r=function(p){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(p,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(p,"__esModule",{value:!0})},s.t=function(p,d){if(1&d&&(p=s(p)),8&d||4&d&&typeof p=="object"&&p&&p.__esModule)return p;var u=Object.create(null);if(s.r(u),Object.defineProperty(u,"default",{enumerable:!0,value:p}),2&d&&typeof p!="string")for(var b in p)s.d(u,b,(function(S){return p[S]}).bind(null,b));return u},s.n=function(p){var d=p&&p.__esModule?function(){return p.default}:function(){return p};return s.d(d,"a",d),d},s.o=function(p,d){return Object.prototype.hasOwnProperty.call(p,d)},s.p="",s(s.s=1);function s(p){if(g[p])return g[p].exports;var d=g[p]={i:p,l:!1,exports:{}};return h[p].call(d.exports,d,d.exports,s),d.l=!0,d.exports}var h,g})})(ke);var mt=ke.exports;const pt=Me(mt),ht=async o=>new Promise((l,c)=>{const s=new FileReader;s.onload=h=>{var g,p;try{if(!((g=h.target)!=null&&g.result))throw new Error("Failed to read file");const d=h.target.result,u=new Uint8Array(d),b=pt.parseDicom(u),S={patientName:b.string("x00100010"),patientId:b.string("x00100020"),studyDate:b.string("x00080020"),modality:b.string("x00080060"),pixelSpacing:(p=b.string("x00280030"))==null?void 0:p.split("\\").map(Number),windowCenter:Number(b.string("x00281050")),windowWidth:Number(b.string("x00281051"))};l(S)}catch{l({modality:"Unknown",studyDate:new Date().toISOString().split("T")[0]})}},s.onerror=()=>c(new Error("Error reading file")),s.readAsArrayBuffer(o)}),gt=o=>new Promise((l,c)=>{const s=new FileReader;s.onload=()=>{typeof s.result=="string"?l(s.result):c(new Error("Failed to read file"))},s.onerror=()=>{c(new Error("Failed to read file"))},s.readAsDataURL(o)}),yt=({setCurrentImage:o,setMetadata:l})=>{const[c,s]=E.useState(null),[h,g]=E.useState(null),[p,d]=E.useState(!1),[u,b]=E.useState(!1),[S,N]=E.useState(""),[I,R]=E.useState(1),L=E.useRef(null),D=E.useRef(null),F=E.useRef(null),Z=E.useCallback(async y=>{var A;const v=(A=y.target.files)==null?void 0:A[0];if(v)try{const J=await ht(v);l(J);const M=await gt(v);o(v),s(M);const T=new Image;T.src=M,T.onload=()=>g(T)}catch(J){console.error("Error loading file:",J),alert("Error loading file. Please ensure it's a valid image format.")}},[o,l]),H=()=>{const y=L.current;if(y){const v=y.getContext("2d");v&&(D.current=v,v.clearRect(0,0,y.width,y.height),F.current&&(y.width=F.current.width*I,y.height=F.current.height*I,v.drawImage(F.current,0,0,y.width,y.height)))}},ie=y=>{if(p&&D.current){const v=D.current,A=L.current;if(!A)return;v.beginPath(),v.moveTo(y.clientX-A.offsetLeft,y.clientY-A.offsetTop)}},Q=y=>{if(p&&D.current){const v=D.current,A=L.current;if(!A)return;v.lineTo(y.clientX-A.offsetLeft,y.clientY-A.offsetTop),v.stroke()}},O=()=>{p&&D.current&&D.current.closePath()},$=y=>{N(y.target.value)},K=()=>{if(D.current&&S){const y=D.current;if(!L.current)return;y.font="20px Arial",y.fillStyle="red",y.fillText(S,50,50),N(""),b(!1)}},U=()=>{R(y=>Math.min(y+.2,3))},oe=()=>{R(y=>Math.max(y-.2,.5))};return E.useEffect(()=>{F.current&&H()},[F.current,I]),m.jsxs("div",{className:"flex items-start justify-center w-full min-h-screen bg-gray-50",children:[m.jsxs("div",{className:"flex flex-col items-start gap-4 p-4 w-72 bg-white border-r shadow-lg",children:[m.jsxs("label",{className:"flex items-center gap-2 bg-white px-4 py-2 rounded-lg shadow-lg cursor-pointer hover:bg-gray-50 transition-colors",children:[m.jsx(Ke,{size:20}),m.jsx("span",{className:"text-sm font-medium",children:"Choose File to Upload"}),m.jsx("input",{type:"file",accept:"image/*,.dcm",onChange:Z,className:"hidden"})]}),m.jsx("button",{onClick:()=>d(!p),className:"bg-blue-500 text-white px-4 py-2 rounded-lg",children:p?"Stop Drawing":"Start Drawing"}),m.jsx("button",{onClick:()=>b(!u),className:"bg-green-500 text-white px-4 py-2 rounded-lg",children:u?"Cancel Text":"Add Text"}),u&&m.jsxs("div",{children:[m.jsx("input",{type:"text",value:S,onChange:$,placeholder:"Enter text",className:"mt-2 p-2 border rounded"}),m.jsx("button",{onClick:K,className:"bg-red-500 text-white px-4 py-2 rounded-lg mt-2",children:"Add Text"})]}),m.jsx("button",{onClick:U,className:"bg-yellow-500 text-white px-4 py-2 rounded-lg mt-4",children:"Zoom In"}),m.jsx("button",{onClick:oe,className:"bg-yellow-500 text-white px-4 py-2 rounded-lg mt-2",children:"Zoom Out"})]}),m.jsx("div",{className:"flex-1 flex justify-center items-center p-4",children:c&&m.jsxs("div",{className:"relative",children:[m.jsx("img",{ref:F,src:c,alt:"Preview",style:{transform:`scale(${I})`,width:"auto",height:"auto"},className:"max-w-full max-h-full object-contain"}),m.jsx("canvas",{ref:L,width:h?h.width*I:500,height:h?h.height*I:500,onMouseDown:ie,onMouseMove:Q,onMouseUp:O,className:"absolute top-0 left-0 border"})]})})]})},xt=()=>{const{metadata:o}=ue();return console.log("Current Metadata:",o),o?m.jsxs("div",{className:"fixed left-0 top-0 h-full w-64 bg-white dark:bg-gray-800 shadow-lg p-4 overflow-y-auto",children:[m.jsx("h2",{className:"text-lg font-semibold mb-4 dark:text-white",children:"DICOM Metadata"}),m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{children:[m.jsx("h3",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Patient Name"}),m.jsx("p",{className:"dark:text-white",children:o.patientName||"N/A"})]}),m.jsxs("div",{children:[m.jsx("h3",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Patient ID"}),m.jsx("p",{className:"dark:text-white",children:o.patientId||"N/A"})]}),m.jsxs("div",{children:[m.jsx("h3",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Study Date"}),m.jsx("p",{className:"dark:text-white",children:o.studyDate||"N/A"})]}),m.jsxs("div",{children:[m.jsx("h3",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Modality"}),m.jsx("p",{className:"dark:text-white",children:o.modality||"N/A"})]}),m.jsxs("div",{children:[m.jsx("h3",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Pixel Spacing"}),m.jsx("p",{className:"dark:text-white",children:o.pixelSpacing?`${o.pixelSpacing[0]} mm x ${o.pixelSpacing[1]} mm`:"N/A"})]}),m.jsxs("div",{children:[m.jsx("h3",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Window Settings"}),m.jsxs("p",{className:"dark:text-white",children:["C: ",o.windowCenter||"N/A"," / W: ",o.windowWidth||"N/A"]})]})]})]}):null},bt=()=>{const{isDarkMode:o,setZoom:l}=ue(),[c,s]=E.useState(void 0),[h,g]=E.useState(1),p=E.useCallback(()=>{const b=h+.1;l(b),g(b)},[h,l]),d=E.useCallback(()=>{const b=Math.max(h-.1,.1);l(b),g(b)},[h,l]),u=E.useCallback(()=>{if(c){const b=new Image;b.src=URL.createObjectURL(c);const S=window.open("","_blank");S==null||S.document.write(`<img src="${b.src}" style="max-width:100%; height:auto;" />`)}else console.log("No image loaded to preview.")},[c]);return m.jsxs("div",{className:o?"dark":"",children:[m.jsx(Oe,{zoomIn:p,zoomOut:d,pan:()=>{},crop:()=>{},adjustBrightness:()=>{},adjustContrast:()=>{},draw:()=>{},addText:()=>{}}),m.jsx(dt,{}),m.jsx(yt,{setCurrentImage:s,setMetadata:()=>{},zoomIn:p,zoomOut:d,pan:()=>{},oneFixCulla:u}),m.jsx(xt,{})]})};Se(document.getElementById("root")).render(m.jsx(E.StrictMode,{children:m.jsx(bt,{})}));
